{% extends "base.html" %}
{% block content %}
<div class="faq rounded w-full bg-white py-4 px-3 shadow-lg my-5 px-3">
  <div class="w-ful">
    <p class="ans-author text-xl font-medium mt-1 mx-2">{{question.content}}</p>
    <div class="flex justify-between items-center py-3 px-3">
      <div class="flex items-center justify-start">
        <img src="{{question.author.profile_img_url}}" class="ans-img h-9 w-9 object-cover rounded-full flex-shrink-0"/>
        <div class="ml-2">
          <p class="text-sm text-gray-500 mt-0.5" >{{question.author.name}}</p>
          <p class="text-xs font-light text-gray-500">
            {{question.author.designation.title}} | {{question.author.organization.name}}
          </p>
        </div>
      </div>
      <div class="flex flex-col items-end">
        <p class="text-xs font-light text-gray-500 ">{{question.posted_on}}</p>
        <p id="answer-focus" class="text-sm mt-1 text-accent cursor-pointer">Answer</p>
      </div>
    </div>
  </div>
</div>
<!-- <p>Question: {{question.content}}</p> -->

{% for ans in answers %}
<div class="faq rounded w-full bg-white py-4 px-3 shadow-lg my-10 px-3">
  <div class="w-full">
    <div class="flex justify-between py-3 px-3">
      <div class="flex items-center justify-start">
        <div class=" rounded-full h-12 w-12 overflow-hidden flex items-center justify-center flex-shrink-0">
          <img src="{{ans.author.profile_img_url}}" class="ans-img h-14 w-14 object-cover"/>
        </div>
        <div class="mx-4">
          <p class="ans-author mt-1">{{ans.author.name}}</p>
          <p class="text-sm text-gray-400">
            {{ans.author.designation.title}} | {{ans.author.organization.name}}
          </p>
        </div>
      </div>
      <p class="text-xs font-light text-gray-500 mt-2">{{ans.posted_on}}</p>
    </div>
    <div class="">
      <p class="ans-content text-sm text-gray-500 m-2">
        {{ans.content}}
      </p>
    </div>
  </div>
</div>
{% endfor %}


<div class="faq rounded w-full bg-white py-2 shadow-lg my-10">
  <div class="mx-4 border-solid border-b-2 border-gray-200 py-1 px-2">
    <p class="text-lg font-medium ans-author mt-1">Write an answer</p>
  </div>

  <form id="ans-form" action="{% url 'faq:create_answer' id=question.pk %}" method="POST" class="flex flex-col mx-4 mt-4 px-2">
    {% csrf_token %}

    <textarea class="w-full py-4 px-6 h-52 bg-gray-100 rounded-lg font-light" name="content" placeholder="Write something here..."></textarea>
    <button type="submit" id="ans-submit" class="bg-accent py-0.5 px-7 text-white mt-4 mb-2 rounded self-end">Post</button>
  </form>
</div>

{% endblock content %}

{% block right-pane %}
  {% include "alumni_answers.html" %}
{% endblock %}

{% block scripts %}
  <script>
    $(document).ready(function () {
      $("#ans-submit").click((e) => {
        e.preventDefault();
        if($("textarea", $("#ans-form")).val().length === 0) alert("Sorry, empty answer isn't accepted!");
        else {
          $("#ans-form").submit();
        }
      });
      $('#answer-focus').on('click', function(e){
        $('html, body').animate({
          scrollTop: $('#ans-form textarea').offset().top - 200
        }, 1000);
        setTimeout(()=>{
          $('#ans-form textarea')[0].focus();
        },1000);
      })

    });
  </script>
{% endblock scripts %}